<!doctype html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ğŸ›¡ï¸ ××¢×¨×›×ª ××‘×˜×—×” ××ª×§×“××ª | Security Dashboard</title>

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Awesome 6 -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />

    <!-- Chart.js -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.css"
    />

    <!-- Fancybox for media gallery -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/style.css" />

    <style>
      :root {
        --primary-color: #4e54c8;
        --secondary-color: #8f94fb;
        --accent-color: #ff6b6b;
        --success-color: #20c997;
        --warning-color: #ffc107;
        --danger-color: #dc3545;
        --info-color: #0dcaf0;
        --dark-color: #212529;
        --light-color: #f8f9fa;
        --card-bg: rgba(255, 255, 255, 0.95);
        --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        --gradient-primary: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--secondary-color) 100%
        );
        --gradient-accent: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
        --transition-normal: all 0.3s ease;
      }

      [data-bs-theme="dark"] {
        --card-bg: rgba(33, 37, 41, 0.95);
        --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      body {
        background: var(--gradient-primary);
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        min-height: 100vh;
        transition: var(--transition-normal);
      }

      .dashboard-container {
        padding: 20px;
      }

      .card {
        border: none;
        border-radius: 15px;
        box-shadow: var(--card-shadow);
        backdrop-filter: blur(10px);
        background: var(--card-bg);
        margin-bottom: 20px;
        transition: var(--transition-normal);
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
      }

      .card-header {
        background: var(--gradient-primary);
        color: white;
        border-radius: 15px 15px 0 0 !important;
        border: none;
        padding: 15px 20px;
      }

      .video-container {
        position: relative;
        border-radius: 10px;
        overflow: hidden;
        background: #000;
        aspect-ratio: 16/9;
        max-height: 500px;
      }

      .video-stream {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      .status-indicators {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 10;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .status-badge {
        padding: 5px 10px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 0.8rem;
        display: flex;
        align-items: center;
        gap: 5px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      }

      .status-live {
        background: var(--success-color);
        color: white;
        animation: pulse 2s infinite;
      }

      .status-audio {
        background: var(--info-color);
        color: white;
      }

      .status-recording {
        background: var(--danger-color);
        color: white;
        animation: blink 1s infinite;
      }

      .status-offline {
        background: var(--dark-color);
        color: white;
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
        100% {
          opacity: 1;
        }
      }

      @keyframes blink {
        0%,
        50% {
          opacity: 1;
        }
        51%,
        100% {
          opacity: 0.5;
        }
      }

      .control-panel {
        background: linear-gradient(45deg, #a8edea 0%, #fed6e3 100%);
        border-radius: 15px;
        padding: 20px;
        margin-top: 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
      }

      .control-btn {
        border-radius: 50px;
        padding: 10px 20px;
        border: none;
        font-weight: bold;
        transition: var(--transition-normal);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .control-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      .control-btn.recording {
        background: var(--danger-color);
        color: white;
        animation: pulse 1s infinite;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 15px;
      }

      .stat-card {
        background: var(--gradient-accent);
        color: white;
        padding: 15px;
        border-radius: 15px;
        text-align: center;
        transition: var(--transition-normal);
        cursor: pointer;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .stat-card:hover {
        transform: translateY(-5px) scale(1.03);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      }

      .stat-card.audio {
        background: linear-gradient(45deg, #a8edea 0%, #fed6e3 100%);
        color: var(--dark-color);
      }

      .stat-card.system {
        background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
      }

      .stat-value {
        font-size: 1.8rem;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .stat-label {
        font-size: 0.8rem;
        opacity: 0.9;
      }

      .media-tabs .nav-link {
        border-radius: 10px;
        padding: 10px 15px;
        margin-right: 5px;
        font-weight: bold;
        color: var(--dark-color);
        transition: var(--transition-normal);
      }

      .media-tabs .nav-link.active {
        background: var(--gradient-primary);
        color: white;
      }

      .media-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 10px;
        max-height: 400px;
        overflow-y: auto;
        padding: 10px;
      }

      .media-item {
        position: relative;
        border-radius: 10px;
        overflow: hidden;
        cursor: pointer;
        transition: var(--transition-normal);
        aspect-ratio: 1/1;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      }

      .media-item:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .media-item img,
      .media-item video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .media-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
        color: white;
        padding: 8px;
        font-size: 0.8rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .media-actions {
        position: absolute;
        top: 5px;
        right: 5px;
        display: flex;
        gap: 5px;
        opacity: 0;
        transition: var(--transition-normal);
      }

      .media-item:hover .media-actions {
        opacity: 1;
      }

      .media-action-btn {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.8);
        color: var(--dark-color);
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        transition: var(--transition-normal);
      }

      .media-action-btn:hover {
        background: white;
        transform: scale(1.1);
      }

      .alert-log {
        max-height: 300px;
        overflow-y: auto;
        padding: 10px;
      }

      .alert-item {
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 10px;
        border-right: 4px solid var(--danger-color);
        background: rgba(255, 255, 255, 0.1);
        transition: var(--transition-normal);
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .alert-item:hover {
        transform: translateX(-5px);
        background: rgba(255, 255, 255, 0.2);
      }

      .alert-item.sound {
        border-right-color: var(--info-color);
      }

      .alert-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--danger-color);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
      }

      .alert-item.sound .alert-icon {
        background: var(--info-color);
      }

      .alert-content {
        flex: 1;
      }

      .connection-status {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1000;
        padding: 10px 15px;
        border-radius: 50px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        transition: var(--transition-normal);
      }

      .connected {
        background: var(--success-color);
        color: white;
      }

      .disconnected {
        background: var(--danger-color);
        color: white;
      }

      .audio-visualizer {
        background: #000;
        border-radius: 10px;
        padding: 15px;
        margin: 15px 0;
      }

      .volume-bar {
        width: 100%;
        height: 20px;
        background: #333;
        border-radius: 10px;
        overflow: hidden;
        margin: 10px 0;
      }

      .volume-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--success-color),
          var(--warning-color),
          var(--danger-color)
        );
        width: 0%;
        transition: width 0.1s ease;
      }

      .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: white;
        color: var(--dark-color);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        border: none;
        transition: var(--transition-normal);
      }

      .theme-toggle:hover {
        transform: rotate(30deg);
      }

      .search-bar {
        position: relative;
        margin-bottom: 15px;
      }

      .search-bar input {
        width: 100%;
        padding: 10px 15px;
        padding-left: 40px;
        border-radius: 50px;
        border: none;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        transition: var(--transition-normal);
      }

      .search-bar input:focus {
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        outline: none;
      }

      .search-bar i {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #aaa;
      }

      .filter-buttons {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
        flex-wrap: wrap;
      }

      .filter-btn {
        padding: 5px 15px;
        border-radius: 50px;
        border: none;
        background: #eee;
        color: var(--dark-color);
        font-weight: bold;
        transition: var(--transition-normal);
      }

      .filter-btn.active {
        background: var(--primary-color);
        color: white;
      }

      .filter-btn:hover {
        transform: translateY(-2px);
      }

      .notification-center {
        position: fixed;
        top: 20px;
        right: 80px;
        z-index: 1000;
        max-width: 300px;
      }

      .toast {
        background: white;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        margin-bottom: 10px;
        overflow: hidden;
      }

      .toast-header {
        background: var(--gradient-primary);
        color: white;
        border: none;
      }

      .toast-body {
        padding: 15px;
      }

      .system-controls {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 15px;
      }

      .system-control-btn {
        flex: 1;
        min-width: 120px;
        padding: 15px;
        border-radius: 10px;
        border: none;
        background: var(--light-color);
        color: var(--dark-color);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        transition: var(--transition-normal);
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      }

      .system-control-btn:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }

      .system-control-btn i {
        font-size: 2rem;
      }

      .system-control-btn.active {
        background: var(--success-color);
        color: white;
      }

      .system-control-btn.inactive {
        background: var(--danger-color);
        color: white;
      }

      /* Responsive adjustments */
      @media (max-width: 768px) {
        .dashboard-container {
          padding: 10px;
        }

        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .media-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .control-panel {
          padding: 15px;
        }

        .control-btn {
          padding: 8px 15px;
          font-size: 0.9rem;
        }

        .system-control-btn {
          min-width: 100px;
          padding: 10px;
        }

        .system-control-btn i {
          font-size: 1.5rem;
        }
      }

      @media (max-width: 576px) {
        .stats-grid {
          grid-template-columns: 1fr;
        }

        .theme-toggle,
        .connection-status {
          width: 40px;
          height: 40px;
          font-size: 1.2rem;
        }

        .connection-status span {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- ×¡×˜×˜×•×¡ ×—×™×‘×•×¨ -->
    <div id="connectionStatus" class="connection-status disconnected">
      <i class="fas fa-wifi"></i>
      <span>××ª×—×‘×¨...</span>
    </div>

    <!-- ×›×¤×ª×•×¨ ×”×—×œ×¤×ª ×¢×¨×›×ª × ×•×©× -->
    <button id="themeToggle" class="theme-toggle">
      <i class="fas fa-moon"></i>
    </button>

    <!-- ××¨×›×– ×”×ª×¨××•×ª -->
    <div class="notification-center" id="notificationCenter"></div>

    <div class="container-fluid dashboard-container">
      <!-- ×›×•×ª×¨×ª -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header text-center">
              <h1><i class="fas fa-shield-alt"></i> ××¢×¨×›×ª ××‘×˜×—×” ××ª×§×“××ª</h1>
              <p class="mb-0">× ×™×˜×•×¨ ×•×™×“××•, ××•×“×™×• ×•×”×ª×¨××•×ª ×‘×–××Ÿ ×××ª</p>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <!-- ×•×™×“××• ×•×‘×§×¨×” -->
        <div class="col-lg-8">
          <!-- ×•×™×“××• ×—×™ -->
          <div class="card">
            <div
              class="card-header d-flex justify-content-between align-items-center"
            >
              <h5><i class="fas fa-video"></i> ×©×™×“×•×¨ ×—×™</h5>
              <div>
                <button class="btn btn-sm btn-outline-light" id="fullscreenBtn">
                  <i class="fas fa-expand"></i>
                </button>
              </div>
            </div>
            <div class="card-body p-0">
              <div class="video-container" id="videoContainer">
                <img
                  id="videoStream"
                  class="video-stream"
                  src="/video_feed"
                  alt="Video Stream"
                />
                <div class="status-indicators">
                  <div id="videoStatus" class="status-badge status-live">
                    <i class="fas fa-video"></i> ×©×™×“×•×¨ ×—×™
                  </div>
                  <div id="audioStatus" class="status-badge status-audio">
                    <i class="fas fa-microphone"></i> ××•×“×™×• ×¤×¢×™×œ
                  </div>
                  <div
                    id="motionStatus"
                    class="status-badge status-offline"
                    style="display: none"
                  >
                    <i class="fas fa-running"></i> ×–×•×”×ª×” ×ª× ×•×¢×”
                  </div>
                  <div
                    id="recordingStatus"
                    class="status-badge status-recording"
                    style="display: none"
                  >
                    <i class="fas fa-circle"></i> ××§×œ×™×˜
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ×•×™×–×•××œ×™×–×¦×™×™×ª ××•×“×™×• -->
          <div class="card">
            <div class="card-header">
              <h5><i class="fas fa-volume-up"></i> × ×™×˜×•×¨ ××•×“×™×•</h5>
            </div>
            <div class="card-body">
              <div class="audio-visualizer">
                <div class="row">
                  <div class="col-md-8">
                    <small class="text-light">×¨××ª ×§×•×œ × ×•×›×—×™×ª</small>
                    <div class="volume-bar">
                      <div id="volumeFill" class="volume-fill"></div>
                    </div>
                    <div class="d-flex justify-content-between">
                      <span id="volumeText" class="text-success">0 dB</span>
                      <span id="audioThreshold" class="text-warning"
                        >×¡×£: 45 dB</span
                      >
                    </div>
                  </div>
                  <div
                    class="col-md-4 d-flex align-items-center justify-content-center"
                  >
                    <div id="audioIndicator" class="text-center">
                      <i class="fas fa-microphone fa-2x text-success"></i>
                      <div class="mt-2 text-light">×××–×™×Ÿ...</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ×¤×§×“×™ ××¢×¨×›×ª -->
          <div class="card">
            <div class="card-header">
              <h5><i class="fas fa-sliders-h"></i> ×‘×§×¨×ª ××¢×¨×›×ª</h5>
            </div>
            <div class="card-body">
              <div class="system-controls">
                <button class="system-control-btn active" id="cameraToggle">
                  <i class="fas fa-video"></i>
                  <span>××¦×œ××”</span>
                </button>
                <button class="system-control-btn active" id="audioToggle">
                  <i class="fas fa-microphone"></i>
                  <span>××•×“×™×•</span>
                </button>
                <button class="system-control-btn active" id="motionToggle">
                  <i class="fas fa-running"></i>
                  <span>×–×™×”×•×™ ×ª× ×•×¢×”</span>
                </button>
                <button
                  class="system-control-btn active"
                  id="notificationsToggle"
                >
                  <i class="fas fa-bell"></i>
                  <span>×”×ª×¨××•×ª</span>
                </button>
              </div>

              <div class="mt-4">
                <h6>×¨×’×™×©×•×ª ×–×™×”×•×™ ×ª× ×•×¢×”</h6>
                <div class="d-flex align-items-center">
                  <span class="me-2"><i class="fas fa-low-vision"></i></span>
                  <input
                    type="range"
                    class="form-range"
                    id="sensitivitySlider"
                    min="1"
                    max="10"
                    value="5"
                  />
                  <span class="ms-2"><i class="fas fa-eye"></i></span>
                </div>
                <div class="text-center" id="sensitivityValue">
                  ×¨×’×™×©×•×ª ×‘×™× ×•× ×™×ª (5)
                </div>
              </div>

              <div class="mt-4">
                <h6>×¨×’×™×©×•×ª ×–×™×”×•×™ ×§×•×œ</h6>
                <div class="d-flex align-items-center">
                  <span class="me-2"><i class="fas fa-volume-down"></i></span>
                  <input
                    type="range"
                    class="form-range"
                    id="audioSensitivitySlider"
                    min="1"
                    max="10"
                    value="5"
                  />
                  <span class="ms-2"><i class="fas fa-volume-up"></i></span>
                </div>
                <div class="text-center" id="audioSensitivityValue">
                  ×¨×’×™×©×•×ª ×‘×™× ×•× ×™×ª (5)
                </div>
              </div>
            </div>
          </div>

          <!-- ×¤×§×“×™× ××”×™×¨×™× -->
          <div class="control-panel">
            <button id="captureBtn" class="btn btn-primary control-btn">
              <i class="fas fa-camera"></i> ×¦×™×œ×•× ××¡×š
            </button>
            <button id="recordBtn" class="btn btn-danger control-btn">
              <i class="fas fa-microphone"></i> ×”×§×œ×˜ ××•×“×™×•
            </button>
            <button
              id="stopRecordBtn"
              class="btn btn-warning control-btn"
              style="display: none"
            >
              <i class="fas fa-stop"></i> ×¢×¦×•×¨ ×”×§×œ×˜×”
            </button>
            <button id="playVoiceBtn" class="btn btn-info control-btn">
              <i class="fas fa-volume-up"></i> ×”×©××¢ ×”×•×“×¢×”
            </button>
            <button id="refreshBtn" class="btn btn-secondary control-btn">
              <i class="fas fa-sync"></i> ×¨×¢× ×•×Ÿ
            </button>
          </div>
        </div>

        <!-- ×¡×˜×˜×™×¡×˜×™×§×•×ª ×•××“×™×” -->
        <div class="col-lg-4">
          <!-- ×¡×˜×˜×™×¡×˜×™×§×•×ª -->
          <div class="card">
            <div class="card-header">
              <h5><i class="fas fa-chart-line"></i> ×¡×˜×˜×™×¡×˜×™×§×•×ª ××¢×¨×›×ª</h5>
            </div>
            <div class="card-body">
              <div class="stats-grid">
                <div class="stat-card">
                  <div id="motionCount" class="stat-value">0</div>
                  <div class="stat-label">×ª× ×•×¢×•×ª</div>
                </div>
                <div class="stat-card audio">
                  <div id="soundCount" class="stat-value">0</div>
                  <div class="stat-label">×”×ª×¨××•×ª ×§×•×œ</div>
                </div>
                <div class="stat-card">
                  <div id="capturesCount" class="stat-value">0</div>
                  <div class="stat-label">×ª××•× ×•×ª</div>
                </div>
                <div class="stat-card audio">
                  <div id="recordingsCount" class="stat-value">0</div>
                  <div class="stat-label">×”×§×œ×˜×•×ª</div>
                </div>
                <div class="stat-card system">
                  <div id="uptime" class="stat-value">00:00</div>
                  <div class="stat-label">×–××Ÿ ×¤×¢×™×œ×•×ª</div>
                </div>
                <div class="stat-card system">
                  <div id="lastMotion" class="stat-value">--:--</div>
                  <div class="stat-label">×ª× ×•×¢×” ××—×¨×•× ×”</div>
                </div>
              </div>

              <div class="mt-4">
                <canvas id="activityChart" height="150"></canvas>
              </div>
            </div>
          </div>

          <!-- ×××’×¨ ××“×™×” -->
          <div class="card">
            <div class="card-header">
              <h5><i class="fas fa-photo-video"></i> ×××’×¨ ××“×™×”</h5>
            </div>
            <div class="card-body">
              <ul
                class="nav nav-pills media-tabs mb-3"
                id="mediaTabs"
                role="tablist"
              >
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link active"
                    id="photos-tab"
                    data-bs-toggle="pill"
                    data-bs-target="#photos"
                    type="button"
                    role="tab"
                  >
                    <i class="fas fa-images"></i> ×ª××•× ×•×ª
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link"
                    id="recordings-tab"
                    data-bs-toggle="pill"
                    data-bs-target="#recordings"
                    type="button"
                    role="tab"
                  >
                    <i class="fas fa-music"></i> ×”×§×œ×˜×•×ª
                  </button>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>

    <!-- Custom JavaScript -->
    <script src="/static/enhanced-dashboard.js"></script>
  </body>
</html>
